<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content><meta name=generator content="Hugo 0.119.0"><meta name=viewport content="width=device-width,initial-scale=1"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-188010236-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<link rel=stylesheet href=/css/style.css type=text/css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700" type=text/css><link rel=alternate href=/index.xml type=application/rss+xml title=Auh><title>Auh</title></head><body><header><div class="container clearfix"><a class=path href>[Auh]</a>
<span class=caret># _</span><div class=right></div></div></header><div class=container><main role=main class=article><article class=single itemscope itemtype=http://schema.org/BlogPosting><div class=meta><span class=key>published on</span>
<span class=val><time itemprop=datePublished datetime="2020-12-27 19:55:10">2020-12-27 19:55:10</time></span>
<span class=key>1123 words</span></div><h1 class=headline itemprop=headline>Java设计(三) 面向封装</h1><section class=body itemprop=articleBody><h1 id=可继承可扩展如何高效编写类来生产对象>可继承，可扩展，如何高效编写类来生产对象</h1><p>这里说的封装的概念。更多指的是自己的功能模块的封装。</p><p>事情是因为，自己编写的一个代理测试类。</p><p>基本需求，有一个巨大的存着很多代理服务器的文件。对这些服务器进行延迟测试，并且返回前几个延迟较低的代理。</p><p>自己的实现：</p><ol><li>编写了一个json解析类，解析出来，json文件的所有代理，并且以代理服务器对象的集合返回。</li><li>编写了一个ping工具类，输入一个集合代理，然后进行多线程ping操作。根据速度，排序，返回前几个延迟低的。</li><li>一个main类，分别，调用json解析，获取代理对象集合，然后出入ping对象，ping对象执行测试，返回结果。</li></ol><p>实现之后，从功能分类的对象设计来讲，我分析的还可以。json一个类，ping工具一个类。然后一个主方法，顺序调用。</p><p>朋友对我代码，评价已经可以了。但是，我觉得，这些都是假的，因为他们都不行，哈哈哈。我隐约觉得，这里面有事情。首先，我觉得还有优化的地方，就是这个工具不具备通用性，应该不光是来自json文件，来自网络文件，或者来自其它地方的都能处理。最好了。当时，这个想法可能是多写几个类。所以，没啥意思，也就不想了。</p><p>之前xingesdk被一个十年大佬，看上去像一个大公司的架构师。主动发起pull request将我修改的代码合到了他的fork分支。我查看了他的仓库，发现他基于我的进一步的进行了修改。查阅修改代码。发现他加了好几个接口类。当时，我觉察到了这一个特殊情况，但是没有过多分析。</p><p>一个自己独处一室的深夜，各种画面和想法在脑子里面盘旋，突然这件事情闪现出来。似乎，我知道人家的用意了。我提出了一个概念。你写的代码是否能够打包，被他人扩展和使用。这就是代码的封装。面向接口的设计自己的代码，能够让自己的代码扩展性增强。并且别人直接使用你打的包。就非常ok。</p><p>于是，对代码进行重构。</p><ol><li><p>定义，资源路径，资源解析器，接口。用来处理不同的资源，默认使用内置的json解析器，处理json路径的资源。可以新增网络解析器，或者文件解析器，来出来其他路径的资源。</p></li><li><p>定义，代理测试接口。可以从不同维度进行测试代理服务器的能力，返回能力排序的集合，默认使用ping代理实现类的方式。这样其他人使用的时候，可以传入自己的测试方式。</p></li><li><p>定义，代理测试主类，构造器初始化的时候，允许传入，自定义资源解析器，和自定义代理测试接口实现类。同时，如果没有传入将使用默认的资源解析器，和代理测试实现类。然后，主类里面，运行测试，就进行解析器接口的调用然后再调用测试实现类的测试方法。最后返回结果。</p></li></ol><p>这样打包好之后，被人可以随便用。并且扩展性非常好。对比之前的设计就天差地别了。</p><p>可扩展的模块，封装才有意义。接口的使用起到了关键作用。</p></section></article></main><script async src="https://www.googletagmanager.com/gtag/js?id=G-4VV6CRVEP7"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4VV6CRVEP7")</script></div><footer><div class=container><span class=copyright>Many Thanks to Vscode-Github-Hugo-Base16 Developers</span></div></footer></body></html>